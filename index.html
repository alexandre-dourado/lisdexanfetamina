<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADHD Log | Minimalist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            color: #1a1a1a;
            overflow: hidden;
        }

        .sidebar-scroll {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .sidebar-scroll::-webkit-scrollbar {
            display: none;
        }

        .active-day {
            background-color: #000;
            color: #fff;
        }

        .glass-detail {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-tool {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            border-radius: 0;
            font-size: 0.7rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.2s;
            border: 1px solid #e5e7eb;
            background: white;
        }

        .btn-tool:hover {
            background: #f9fafb;
            border-color: #000;
        }

        /* Corrigindo e aprimorando Tooltips */
        .tooltip-container {
            position: relative;
            display: inline-flex;
            align-items: center;
            cursor: help;
        }

        .tooltip-content {
            visibility: hidden;
            width: 300px;
            background-color: #1a1a1a;
            color: #fff;
            text-align: left;
            padding: 16px;
            position: absolute;
            z-index: 100;
            bottom: 140%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.2s, transform 0.2s;
            font-size: 11px;
            line-height: 1.6;
            font-weight: normal;
            text-transform: none;
            letter-spacing: normal;
            pointer-events: none;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            white-space: pre-wrap; /* Mant√©m quebras de linha */
            border: 1px solid #333;
        }

        .tooltip-container:hover .tooltip-content {
            visibility: visible;
            opacity: 1;
            transform: translateX(-50%) translateY(-5px);
        }

        .tooltip-content::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border-width: 8px;
            border-style: solid;
            border-color: #1a1a1a transparent transparent transparent;
        }

        /* Harm Reduction Reveal Transition */
        .reveal-container .overlay {
            transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .reveal-container:hover .overlay {
            opacity: 0;
            pointer-events: none;
        }
    </style>
</head>
<body class="flex h-screen overflow-hidden bg-gray-50">

    <!-- SIDEBAR: HIST√ìRICO -->
    <aside class="w-64 md:w-80 bg-white border-r border-gray-200 flex flex-col h-full shrink-0">
        <div class="p-6 border-b border-gray-100 flex justify-between items-center">
            <h1 class="font-extrabold text-xl tracking-tighter uppercase flex items-center gap-2">
                <i data-lucide="clipboard-list" class="w-5 h-5 text-red-600"></i>
                Di√°rio TDAH
            </h1>
            <button onclick="fetchData()" class="p-2 hover:bg-gray-100 rounded-full transition-colors" title="Sincronizar Planilha">
                <i data-lucide="refresh-cw" class="w-4 h-4 text-gray-400"></i>
            </button>
        </div>
        
        <nav id="history-list" class="flex-1 overflow-y-auto sidebar-scroll">
            <div class="p-10 text-center text-gray-300 animate-pulse uppercase text-[10px] font-bold">Carregando dados...</div>
        </nav>

        <div class="p-4 bg-gray-50 border-t border-gray-200 text-[10px] font-mono text-gray-400 uppercase tracking-widest text-center">
            v2.6 Swiss Minimalist + Tooltips Fix
        </div>
    </aside>

    <!-- MAIN CONTENT: DETALHES -->
    <main class="flex-1 overflow-y-auto bg-white flex flex-col relative">
        <!-- TOP TOOLBAR -->
        <div class="sticky top-0 z-20 bg-white/80 backdrop-blur-md border-b border-gray-100 px-8 py-4 flex justify-between items-center">
            <div id="priority-hint" class="hidden text-[9px] font-bold uppercase tracking-widest text-gray-400 flex items-center gap-2">
                <div class="tooltip-container">
                    <i data-lucide="info" class="w-3 h-3 text-red-600"></i>
                    <div class="tooltip-content"><strong>üß≠ PRIORIDADE DE OBSERVA√á√ÉO</strong>
Se estiver cansado, observe apenas:
‚Ä¢ Ru√≠do mental
‚Ä¢ Clareza
‚Ä¢ Foco
‚Ä¢ Pico claro
O resto √© contexto.</div>
                </div>
                Prioridade: Ru√≠do, Clareza, Foco e Pico.
            </div>
            <div class="flex gap-2 ml-auto">
                <button onclick="exportJSON()" class="btn-tool">
                    <i data-lucide="download" class="w-3 h-3 text-blue-600"></i> Exportar Tudo
                </button>
                <label class="btn-tool cursor-pointer">
                    <i data-lucide="upload" class="w-3 h-3 text-green-600"></i> Importar
                    <input type="file" id="importJson" accept=".json" class="hidden" onchange="importJSON(event)">
                </label>
                <div id="day-actions" class="hidden flex gap-2">
                    <div class="w-[1px] h-full bg-gray-200 mx-2"></div>
                    <button onclick="exportMarkdown()" class="btn-tool bg-black text-white border-black hover:bg-gray-800">
                        <i data-lucide="file-text" class="w-3 h-3"></i> Exportar Dia (.MD)
                    </button>
                </div>
            </div>
        </div>

        <div id="detail-view" class="flex-1 max-w-4xl mx-auto p-8 md:p-16 w-full">
            <div class="flex flex-col items-center justify-center h-full text-gray-300 italic font-light space-y-4">
                <i data-lucide="layout" class="w-12 h-12 opacity-20"></i>
                <p>Selecione um dia no hist√≥rico para visualizar os detalhes.</p>
            </div>
        </div>
    </main>

    <script>
        const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT1JyTDdbWMSyj6puua-BwPJbfK_c9zie0PPx34P8d0zaUar_t7vPSUGsxNZqQNG1Kr3TeQim9B8xod/pub?gid=0&single=true&output=csv';
        let appData = [];
        let activeIdx = null;

        const COLORS = {
            0: '#850000', 1: '#C00000', 2: '#FF8C00', 3: '#D4FF00', 4: '#4ADE80', 5: '#1D4ED8'
        };

        const TOOLTIPS = {
            ruido: `üß† RU√çDO MENTAL (0‚Äì5)
O que observar: quantidade de pensamentos simult√¢neos.
‚òê Um pensamento por vez
‚òê Pensamentos se interrompem
‚òê Ideias competem entre si

Escala:
0‚Äì1: mente silenciosa ou linear
2‚Äì3: alguns pensamentos paralelos
4‚Äì5: atropelo constante de pensamentos
üìå Ru√≠do diminui sem acelerar.`,

            clareza: `üß© CLAREZA MENTAL (0‚Äì5)
O que observar: nitidez para entender e decidir.
‚òê Entendo o que estou fazendo
‚òê Menos confus√£o interna
‚òê Decis√µes mais diretas

Escala:
0‚Äì1: confus√£o, n√©voa
2‚Äì3: clareza com esfor√ßo
4‚Äì5: clareza espont√¢nea
üìå Clareza ‚â† energia.`,

            cansaco: `üí™ CANSA√áO F√çSICO (0‚Äì5)
O que observar: estado do corpo.
‚òê Corpo pesado
‚òê Olhos ardendo
‚òê Lentid√£o f√≠sica

Escala:
0‚Äì1: corpo leve
2‚Äì3: cansa√ßo toler√°vel
4‚Äì5: corpo arrastado
üìå Estimulante pode mascarar ‚Äî observe cedo.`,

            euforia: `‚ö° EUFORIA
O que observar: eleva√ß√£o artificial de humor.
‚òê Otimismo exagerado
‚òê Empolga√ß√£o fora do padr√£o
‚òê Sensa√ß√£o de ‚Äútudo resolve‚Äù

Marca√ß√£o:
‚òê N√£o | ‚òê Leve | ‚òê Moderada | ‚òê Intensa
üìå Euforia n√£o √© resposta terap√™utica.`,

            ansiedade: `üò∞ ANSIEDADE
O que observar: ativa√ß√£o + desconforto.
‚òê Tens√£o corporal
‚òê Pressa mental
‚òê Inquieta√ß√£o

Marca√ß√£o:
‚òê N√£o | ‚òê Leve | ‚òê Moderada | ‚òê Intensa
üìå Ansiedade vem com urg√™ncia, n√£o clareza.`,

            foco: `üéØ FOCO
O que observar: sustenta√ß√£o da aten√ß√£o.
‚òê Consigo ficar numa tarefa
‚òê Saio da tarefa sem travar
‚òê N√£o fico hiperfixado

Marca√ß√£o:
‚òê Mais cont√≠nuo
‚òê Mais r√≠gido
‚òê Igual ao habitual
üìå Foco terap√™utico √© flex√≠vel.`,

            pico: `üìà PICO CLARO
O que observar: in√≠cio percept√≠vel do efeito.
‚òê ‚ÄúBateu‚Äù claramente
‚òê Mudan√ßa abrupta
‚òê Transi√ß√£o n√≠tida

Marca√ß√£o:
‚òê Sim | ‚òê N√£o
üìå Idealmente, n√£o h√° pico claro.`,

            irritabilidade: `üò† IRRITABILIDADE (fim do dia)
O que observar: toler√¢ncia emocional.
‚òê Sons incomodam mais
‚òê Pessoas irritam f√°cil

Marca√ß√£o: ‚òê Sim | ‚òê N√£o`,

            queda: `üîª QUEDA DE ENERGIA
O que observar: esvaziamento abrupto.
‚òê Cansa√ßo s√∫bito
‚òê Humor despenca

Marca√ß√£o: ‚òê Sim | ‚òê N√£o`,

            sono: `üåô SONO ESPERADO
O que observar: previs√£o honesta.
‚òê Corpo pede descanso
‚òê Mente desacelera

Marca√ß√£o:
‚òê Melhor | ‚òê Igual | ‚òê Pior
üìå √â progn√≥stico, n√£o desejo.`
        };

        function isPositive(val) {
            if (!val) return false;
            const n = String(val).toLowerCase().trim();
            return n === 'sim' || n === 'true' || n === 's';
        }

        function getColor(val) {
            const v = Math.round(parseFloat(String(val).replace(',', '.')) || 0);
            return COLORS[v] || '#e5e7eb';
        }

        async function fetchData() {
            try {
                const response = await fetch(`${CSV_URL}&t=${new Date().getTime()}`);
                const csvText = await response.text();
                appData = parseData(csvText);
                renderHistory();
                if (appData.length > 0) {
                    selectDay(appData.length - 1);
                }
            } catch (error) {
                console.error("Erro ao carregar:", error);
            }
        }

        function parseData(text) {
            const lines = text.trim().split(/\r?\n/);
            if (lines.length < 2) return [];
            const separator = lines[0].includes('\t') ? '\t' : ',';
            const headers = lines[0].split(separator).map(h => h.replace(/^"|"$/g, '').trim());
            return lines.slice(1).map(line => {
                let row = [];
                if (separator === ',') {
                    let field = '', inQuotes = false;
                    for (let c of line) {
                        if (c === '"') inQuotes = !inQuotes;
                        else if (c === ',' && !inQuotes) { row.push(field); field = ''; }
                        else field += c;
                    }
                    row.push(field);
                } else {
                    row = line.split('\t');
                }
                let obj = {};
                headers.forEach((h, i) => { if (h) obj[h] = (row[i] || "").replace(/^"|"$/g, '').trim(); });
                return obj;
            });
        }

        function renderHistory() {
            const list = document.getElementById('history-list');
            if (!appData || appData.length === 0) {
                list.innerHTML = '<div class="p-10 text-center text-gray-300">Nenhum dado encontrado.</div>';
                return;
            }

            list.innerHTML = appData.slice().reverse().map((day, revIdx) => {
                const actualIdx = appData.length - 1 - revIdx;
                const isActive = activeIdx === actualIdx;
                
                return `
                    <div onclick="selectDay(${actualIdx})" 
                         class="px-6 py-5 border-b border-gray-50 cursor-pointer transition-all hover:bg-gray-50 flex items-center justify-between group ${isActive ? 'active-day' : ''}">
                        <div>
                            <p class="text-[10px] font-bold uppercase tracking-widest ${isActive ? 'text-gray-400' : 'text-gray-400'}">${day['Data']}</p>
                            <p class="font-bold text-sm flex items-center gap-1">
                                <i data-lucide="pill" class="w-3 h-3 ${isActive ? 'text-red-400' : 'text-red-600'}"></i>
                                ${day['Dose'] || 'N/A'}
                            </p>
                        </div>
                        <div class="flex space-x-1">
                            <div class="w-1.5 h-6 rounded-full" style="background-color: ${getColor(day['Ru√≠do mental (0‚Äì5)'])}"></div>
                            <div class="w-1.5 h-6 rounded-full" style="background-color: ${getColor(day['Clareza (0‚Äì5)'])}"></div>
                        </div>
                    </div>
                `;
            }).join('');
            lucide.createIcons();
        }

        window.selectDay = (index) => {
            activeIdx = index;
            document.getElementById('day-actions').classList.remove('hidden');
            document.getElementById('priority-hint').classList.remove('hidden');
            renderHistory();
            renderDetail(appData[index]);
        };

        function renderDetail(data) {
            const detail = document.getElementById('detail-view');
            const uso = isPositive(data['Usou coca√≠na']);
            
            detail.innerHTML = `
                <div class="glass-detail space-y-12 pb-20">
                    <!-- HEADER -->
                    <header class="flex flex-col md:flex-row justify-between items-baseline gap-4 border-b-4 border-black pb-8">
                        <div class="flex items-center gap-6">
                             <div class="bg-gray-100 p-4 rounded-full">
                                <i data-lucide="calendar" class="w-10 h-10 text-black"></i>
                             </div>
                             <div>
                                <h2 class="text-6xl font-black tracking-tighter">${data['Data']}</h2>
                                <p class="text-sm font-mono uppercase tracking-[0.3em] text-gray-400 flex items-center gap-2">
                                    <i data-lucide="clock" class="w-3 h-3"></i> Ingest√£o: ${data['Hora rem√©dio']}
                                </p>
                            </div>
                        </div>
                        <div class="bg-black text-white px-8 py-4 text-center">
                            <span class="block text-[10px] uppercase tracking-widest opacity-50 mb-1">Dose Ministrada</span>
                            <span class="text-3xl font-black">${data['Dose']}</span>
                        </div>
                    </header>

                    <!-- GRIDS DE M√âTRICAS -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-16">
                        <div class="space-y-10">
                            <h3 class="text-[10px] font-black uppercase tracking-[0.5em] border-b border-gray-100 pb-2 text-gray-400 flex items-center gap-2">
                                <i data-lucide="brain" class="w-3 h-3"></i> Estado Mental
                            </h3>
                            ${renderMetricLine("Ru√≠do Mental", data['Ru√≠do mental (0‚Äì5)'], "brain-circuit", TOOLTIPS.ruido)}
                            ${renderMetricLine("Clareza Cognitiva", data['Clareza (0‚Äì5)'], "sparkles", TOOLTIPS.clareza)}
                            ${renderMetricLine("Cansa√ßo F√≠sico", data['Cansa√ßo (0‚Äì5)'], "battery-low", TOOLTIPS.cansaco)}

                            <div class="pt-6 space-y-2">
                                <div class="flex items-center gap-2 mb-4">
                                    <div class="tooltip-container">
                                        <h3 class="text-[10px] font-black uppercase tracking-[0.5em] text-gray-400 underline decoration-dotted underline-offset-4">Foco & Fluxo</h3>
                                        <div class="tooltip-content">${TOOLTIPS.foco}</div>
                                    </div>
                                </div>
                                <div class="flex gap-4 items-start">
                                    <i data-lucide="target" class="w-6 h-6 text-black shrink-0 mt-1"></i>
                                    <p class="text-2xl font-semibold leading-tight text-black italic">"${data['Foco'] || 'Sem registro de foco.'}"</p>
                                </div>
                            </div>
                        </div>

                        <div class="space-y-8">
                            <h3 class="text-[10px] font-black uppercase tracking-[0.5em] border-b border-gray-100 pb-2 text-gray-400 flex items-center gap-2">
                                <i data-lucide="activity" class="w-3 h-3"></i> Fisiologia
                            </h3>
                            
                            <!-- Sono em Destaque -->
                            <div class="flex items-center justify-between bg-gray-50 p-6 border-l-4 border-black mb-6">
                                <div class="flex items-center gap-4">
                                    <i data-lucide="moon" class="w-8 h-8 text-gray-400"></i>
                                    <span class="text-lg font-bold uppercase tracking-widest text-gray-600">Tempo de Sono</span>
                                </div>
                                <div class="flex items-baseline">
                                    <span class="text-6xl font-black mr-2">${data['Sono (h)']}</span>
                                    <span class="text-xs font-bold text-gray-400 uppercase">Horas</span>
                                </div>
                            </div>

                            <!-- Badges em Lista -->
                            <div class="flex flex-col gap-3">
                                ${renderBadgeRow("Dormiu Antes", data['Dormiu antes'], "bed", "")}
                                ${renderBadgeRow("Pico de Efeito Percebido", data['Pico claro'], "trending-up", TOOLTIPS.pico)}
                                ${renderBadgeRow("Estado de Euforia", data['Euforia'], "smile", TOOLTIPS.euforia)}
                                ${renderBadgeRow("N√≠vel de Ansiedade", data['Ansiedade'], "alert-circle", TOOLTIPS.ansiedade)}
                                ${renderBadgeRow("Queda Brusca de Energia", data['Queda energia'], "arrow-down-circle", TOOLTIPS.queda)}
                                ${renderBadgeRow("Irritabilidade (Fim do Dia)", data['Irritado fim do dia'], "frown", TOOLTIPS.irritabilidade)}
                                ${renderBadgeRow("Progn√≥stico: Sono Esperado", data['Sono esperado'], "moon-star", TOOLTIPS.sono)}
                            </div>

                            <!-- REDU√á√ÉO DE DANOS COM CAPA -->
                            <div class="reveal-container relative mt-12 overflow-hidden border-2 border-red-600 min-h-[140px] bg-red-50 flex flex-col justify-center">
                                <div class="overlay absolute inset-0 bg-red-600 z-10 flex items-center justify-center text-white cursor-help">
                                    <i data-lucide="zap" class="w-16 h-16"></i>
                                </div>
                                <div class="p-8 space-y-4">
                                    <div class="flex justify-between items-center border-b border-red-200 pb-2">
                                        <span class="text-[10px] font-black uppercase text-red-600 tracking-widest">Uso no Ciclo</span>
                                        <span class="font-black text-2xl ${uso ? 'text-red-700 underline underline-offset-4' : 'text-gray-400'}">
                                            ${uso ? 'SIM' : 'N√ÉO'}
                                        </span>
                                    </div>
                                    <div class="grid grid-cols-2 gap-6 text-[10px] font-bold uppercase">
                                        <div class="flex items-start gap-2">
                                            <i data-lucide="hash" class="w-3 h-3 text-red-300"></i>
                                            <div><p class="text-red-400 opacity-70">Tipo</p><p class="text-red-900">${data['Tipo de uso'] || '---'}</p></div>
                                        </div>
                                        <div class="flex items-start gap-2">
                                            <i data-lucide="message-square" class="w-3 h-3 text-red-300"></i>
                                            <div><p class="text-red-400 opacity-70">Pensamento</p><p class="text-red-900">${data['Pensamento sobre uso'] || '---'}</p></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-12 pt-12 border-t border-gray-100">
                        <h3 class="text-[10px] font-black uppercase tracking-[0.5em] text-gray-400 mb-6 text-center flex items-center justify-center gap-2">
                            <i data-lucide="quote" class="w-3 h-3"></i> Relato Qualitativo
                        </h3>
                        <div class="text-4xl font-light leading-tight tracking-tight text-gray-800 text-center max-w-2xl mx-auto">
                            ${data['Observa√ß√£o curta'] || 'Nenhum insight registrado para este ciclo.'}
                        </div>
                    </div>
                </div>
            `;
            lucide.createIcons();
        }

        function renderMetricLine(label, value, iconName, tooltipText) {
            const color = getColor(value);
            return `<div class="flex items-center space-x-6">
                <div class="w-16 h-16 shrink-0 flex items-center justify-center border-2 border-gray-100 rounded-full text-2xl font-black transition-colors" style="color: ${color}; border-color: ${color}22">
                    ${value}
                </div>
                <div class="flex-1">
                    <div class="flex items-center gap-2 mb-1">
                        <div class="tooltip-container">
                            <i data-lucide="${iconName}" class="w-3 h-3 text-gray-400 mr-1"></i>
                            <p class="text-xs font-bold uppercase tracking-widest text-gray-400 underline decoration-dotted underline-offset-4">${label}</p>
                            <div class="tooltip-content">${tooltipText}</div>
                        </div>
                    </div>
                    <div class="w-full h-1 bg-gray-100 rounded-full overflow-hidden">
                        <div class="h-full transition-all duration-700" style="width: ${(value/5)*100}%; background-color: ${color}"></div>
                    </div>
                </div>
            </div>`;
        }

        function renderBadgeRow(label, val, iconName, tooltipText) {
            const pos = isPositive(val);
            const hasTooltip = tooltipText !== "";
            return `<div class="flex items-center justify-between p-4 border border-gray-100 bg-white hover:border-black transition-all group ${pos ? 'bg-red-50 border-red-300' : ''}">
                <div class="flex items-center gap-4">
                    <i data-lucide="${iconName}" class="w-5 h-5 ${pos ? 'text-red-600' : 'text-gray-300 group-hover:text-black'} transition-colors"></i>
                    
                    <div class="${hasTooltip ? 'tooltip-container' : ''}">
                        <span class="text-gray-500 text-xs flex items-center gap-1 uppercase font-bold tracking-tight ${hasTooltip ? 'underline decoration-dotted underline-offset-4' : ''}">
                            ${label}
                        </span>
                        ${hasTooltip ? `<div class="tooltip-content">${tooltipText}</div>` : ''}
                    </div>
                </div>
                <span class="${pos ? 'text-red-600' : 'text-gray-900'} text-sm font-black tracking-widest uppercase">${val || 'N√ÉO'}</span>
            </div>`;
        }

        /* --- IMPORT/EXPORT FUNCTIONS --- */

        function exportJSON() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = `tdah_tracker_full_export_${new Date().toISOString().slice(0,10)}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importJSON(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const importedData = JSON.parse(e.target.result);
                    if (Array.isArray(importedData)) {
                        appData = importedData;
                        activeIdx = appData.length - 1;
                        renderHistory();
                        selectDay(activeIdx);
                    } else {
                        throw new Error("Formato JSON inv√°lido");
                    }
                } catch (err) {
                    alert("Erro ao importar JSON. Verifique o formato do arquivo.");
                }
            };
            reader.readAsText(file);
        }

        function exportMarkdown() {
            if (activeIdx === null) return;
            const data = appData[activeIdx];
            const uso = isPositive(data['Usou coca√≠na']);
            
            const mdContent = `# Relat√≥rio de Monitoramento TDAH - ${data.Data}

## Informa√ß√µes Gerais
- **Dose:** ${data.Dose}
- **Hora da Ingest√£o:** ${data['Hora rem√©dio']}
- **Sono:** ${data['Sono (h)']}h

## Estado Mental
- **Ru√≠do Mental:** ${data['Ru√≠do mental (0‚Äì5)']}/5
- **Clareza Cognitiva:** ${data['Clareza (0‚Äì5)']}/5
- **N√≠vel de Cansa√ßo:** ${data['Cansa√ßo (0‚Äì5)']}/5
- **Foco:** ${data.Foco || 'N√£o registrado'}

## Fisiologia & Eventos
- **Pico de Efeito:** ${data['Pico claro']}
- **Euforia:** ${data.Euforia}
- **Ansiedade:** ${data.Ansiedade}
- **Crash de Energia:** ${data['Queda energia']}
- **Irritabilidade:** ${data['Irritado fim do dia']}

## Redu√ß√£o de Danos
- **Uso de Subst√¢ncia:** ${uso ? 'SIM' : 'N√ÉO'}
- **Tipo de Uso:** ${data['Tipo de uso'] || 'N/A'}
- **Pensamentos/Impulsividade:** ${data['Pensamento sobre uso'] || 'N/A'}

## Observa√ß√µes
> ${data['Observa√ß√£o curta'] || 'Nenhuma observa√ß√£o registrada.'}

---
*Gerado via TDAH Tracker System*`;

            const blob = new Blob([mdContent], { type: "text/markdown" });
            const url = URL.createObjectURL(blob);
            const link = document.createElement("a");
            link.href = url;
            link.download = `relatorio_tdah_${data.Data.replace(/\//g, '-')}.md`;
            link.click();
            URL.revokeObjectURL(url);
        }

        window.onload = fetchData;
    </script>
</body>
</html>
